# PeMCP Dependencies
#
# These are minimum version constraints (>=) for development flexibility.
# For reproducible production/CI builds, generate a lockfile:
#   pip install -r requirements.txt
#   pip freeze > requirements.lock
# Then install from the lockfile: pip install -r requirements.lock

# --- Core PE Parsing ---
pefile>=2024.8.26

# --- Advanced Binary Analysis & Emulation ---
angr>=9.2
vivisect>=1.1.0
# FLIRT signature parsing (used by angr's built-in FlirtAnalysis)
nampa>=0.1

# --- FLARE Tools (Capabilities & Advanced Strings) ---
flare-floss>=3.0
# NOTE: capa >=9.0 required â€” bundled capa-rules v9.x are not backwards-compatible
flare-capa>=9.0

# --- String Analysis & Ranking ---
# PyPI package name is "stringsifter", NOT "flare-stringsifter"
stringsifter>=3.0
joblib>=1.2
numpy>=1.24
rapidfuzz>=3.0

# --- Signatures, Cryptography & Scanning ---
yara-python>=4.3
signify>=0.7
cryptography>=43.0

# --- Network & API (VirusTotal/Updates) ---
requests>=2.28

# --- Server Infrastructure ---
# Model Context Protocol SDK
mcp[cli]>=1.0

# --- Graph Analysis (used directly for angr CFG processing) ---
networkx>=3.0

# --- Extended Binary Analysis (Optional - graceful degradation) ---
# Multi-format binary parsing and modification (PE/ELF/Mach-O)
lief>=0.15
# Multi-architecture disassembler (standalone shellcode analysis)
capstone>=5.0
# Multi-architecture assembler (patch generation from mnemonics)
keystone-engine>=0.9
# Windows API emulation for malware analysis
speakeasy-emulator>=1.0
# Automatic PE unpacking (UPX, ASPack, FSG, etc.)
unipacker>=1.0
# .NET PE metadata extraction (latest PyPI: 0.2.x)
dotnetfile>=0.2
# Fuzzy hashing for sample similarity
ppdeep>=20200401
# Locality-sensitive hashing
py-tlsh>=4.7
# Embedded file/firmware detection (PyPI only has 2.1.0; 2.3+ is GitHub-only)
binwalk>=2.1

# --- .NET Binary Analysis (Optional) ---
# .NET PE metadata parser (CLR headers, metadata tables, streams)
dnfile>=0.15
# .NET CIL bytecode disassembler (Mandiant FLARE)
dncil>=1.0

# --- Go Binary Analysis (Optional) ---
# Go binary reverse engineering (compiler version, packages, symbols)
pygore>=0.5

# --- Rust Binary Analysis (Optional) ---
# Rust binary metadata extraction (compiler, crates, toolchain)
rustbininfo>=0.5
# Rust symbol demangling
rust-demangler>=1.0

# --- ELF/Linux Binary Analysis (Optional) ---
# ELF and DWARF parser (headers, symbols, debug info)
pyelftools>=0.31

# --- Test Dependencies ---
# Install with: pip install -r requirements.txt -r requirements-test.txt
# pytest
# httpx
